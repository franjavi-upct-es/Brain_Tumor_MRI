seed: 42
framework: tensorflow/keras
data:
  auto_split: false
  train_dir: data/train_medical
  val_dir: data/val_medical
  test_dir: data/test_medical
  root_dir: data/train_medical
  image_size: 224
  channels: 3
  num_classes: 4
  class_names:
  - glioma
  - meningioma
  - no_tumor
  - pituitary
  valid_split: 0.2
  shuffle: true
  balance: true
preprocessing:
  mode: medical
  medical:
    apply_n4_bias_correction: true
    apply_rician_denoising: true
    intensity_normalization: nyul
    enhance_method: clahe
    save_metadata: true
    quality_filter: true
    quality_filter_thresholds:
      min_snr: 2.0
      min_contrast: 50.0
  legacy:
    simple_crop: true
    padding: 0
train:
  batch_size: 64
  epochs: 35
  mixed_precision: true
  lr: 0.001
  optimizer: adamw
  weight_decay: 0.01
  freeze_backbone_epochs: 5
  loss: categorical_crossentropy
  recall_loss: tversky
  tversky_alpha: 0.3
  tversky_beta: 0.7
  focal_alpha: 0.75
  focal_gamma: 2.0
  label_smoothing: 0.0
  pos_weight: 3.0
  early_stopping_patience: 4
  checkpoint_dir: models/
  num_workers: 2
  use_class_weights: true
  use_cosine_decay: true
  holdout_split_external: 0.15
augment:
  random_flip: true
  random_rotate: 0.05
  random_zoom: 0.1
  random_brightness: 0.1
  random_contrast: 0.1
  mixup_alpha: 0.0
  advanced:
    enable: false
    elastic_transform: false
    grid_distortion: false
    optical_distortion: false
model:
  name: efficientnet_v2_b0
  pretrained: true
  dropout: 0.25
  pooling: avg
log:
  csv_log: training_log.csv
  tensorboard_dir: tb/
  save_confusion_matrix: true
  save_classif_report: true
inference:
  tta: false
  tta_samples: 5
  threshold: 0.6000000000000002
  target_recall: 0.9
  max_fp_rate: 0.1
  use_calibration: true
  ensemble:
    enabled: true
    strategy: mean
    checkpoints:
    - finetuned_navoneel.keras
    - best.keras
  triage:
    enabled: true
    band: 0.05
    max_disagreement: 0.1
  mc_dropout:
    enabled: false
    samples: 10
  last_threshold_reason: max recall subject to FP rate<=0.10 (target recall not reached)
calibration:
  enabled: true
  max_iters: 200
pipeline:
  skip_existing_preprocessing: true
  dataset_specific_preprocessing:
    main: medical
    external: medical
    lgg: medical
